.( ## MNIST convolution tests ## ) cr
50 28 28 1 nn.model                        \ create a network model
0.5 10 conv2d 2 maxpool relu               \ add a convolution block
0.5 20 conv2d 0.5 dropout 2 maxpool relu   \ add another convolution block
flatten 0.0 49 linear                      \ add reduction layer, and the
0.5 dropout 0.0 10 linear softmax          \ final fully connected output
constant md0                               \ keep as a constant

md0                                        \ put model on TOS
network                                    \ show model

batchsize dataset mnist_test               \ create MNIST dataset with model batch size
constant ds0                               \ save dataset in a constant

: cnn for forward backprop 0.01 0.0 nn.sgd next ;
: epoch for cnn loss.ce . ds0 rewind next ;
see epoch

ds0
6 epoch                                    \ execute CNN 

bye
